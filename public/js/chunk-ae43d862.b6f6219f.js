(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ae43d862"],{"2af7":function(t,e,o){"use strict";function a(r,i,l,s){return new(l=l||Promise)(function(t,e){function o(t){try{n(s.next(t))}catch(t){e(t)}}function a(t){try{n(s.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new l(function(t){t(e.value)}).then(o,a)}n((s=s.apply(r,i||[])).next())})}function n(o,a){var n,r,i,t,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(i=2&e[0]?r.return:e[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,e[1])).done)return i;switch(r=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,r=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(!(i=0<(i=l.trys).length&&i[i.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){l.label=e[1];break}if(6===e[0]&&l.label<i[1]){l.label=i[1],i=e;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(e);break}i[2]&&l.ops.pop(),l.trys.pop();continue}e=a.call(o,l)}catch(t){e=[6,t],r=0}finally{n=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}o.d(e,"a",function(){return h});var r=["text/plain","text/html"],i=function(){(console.warn||console.log).call(arguments)}.bind(console,"[clipboard-polyfill]"),l=!0,s=(u.prototype.setData=function(t,e){l&&-1===r.indexOf(t)&&i("Unknown data type: "+t,"Call clipboard.suppressWarnings() to suppress this warning."),this.m[t]=e},u.prototype.getData=function(t){return this.m[t]},u.prototype.forEach=function(t){for(var e in this.m)t(this.m[e],e)},u),c=function(t){},d=!0;function u(){this.m={}}var f=function(){(console.warn||console.log).apply(console,arguments)}.bind("[clipboard-polyfill]"),p="text/plain";function m(o){return a(this,void 0,void 0,function(){var e;return n(this,function(t){if(d&&!o.getData(p)&&f("clipboard.write() was called without a `text/plain` data type. On some platforms, this may result in an empty clipboard. Call clipboard.suppressWarnings() to suppress this warning."),_()){if(function(){var t=o.getData(p);if(void 0!==t)return window.clipboardData.setData("Text",t);throw new Error("No `text/plain` value was specified.")}())return[2];throw new Error("Copying failed, possibly because the user rejected it.")}if(b(o))return c("regular execCopy worked"),[2];if(-1<navigator.userAgent.indexOf("Edge"))return c('UA "Edge" => assuming success'),[2];if(v(document.body,o))return c("copyUsingTempSelection worked"),[2];if(function(t){var e=document.createElement("div");e.setAttribute("style","-webkit-user-select: text !important"),e.textContent="temporary element",document.body.appendChild(e);var o=v(e,t);return document.body.removeChild(e),o}(o))return c("copyUsingTempElem worked"),[2];if(void 0!==(e=o.getData(p))&&function(t){c("copyTextUsingDOM");var e=document.createElement("div");e.setAttribute("style","-webkit-user-select: text !important");var o=e;e.attachShadow&&(c("Using shadow DOM."),o=e.attachShadow({mode:"open"}));var a=document.createElement("span");a.innerText=t,o.appendChild(a),document.body.appendChild(e),y(a);var n=document.execCommand("copy");return w(),document.body.removeChild(e),n}(e))return c("copyTextUsingDOM worked"),[2];throw new Error("Copy command failed.")})})}function h(e){return a(this,void 0,void 0,function(){return n(this,function(t){return navigator.clipboard&&navigator.clipboard.writeText?(c("Using `navigator.clipboard.writeText()`."),[2,navigator.clipboard.writeText(e)]):[2,m(x(e))]})})}var g=function(){this.success=!1};function b(t){var e=new g,o=function(a,t,n){c("listener called"),a.success=!0,t.forEach(function(t,e){var o=n.clipboardData;o.setData(e,t),e===p&&o.getData(e)!==t&&(c("setting text/plain failed"),a.success=!1)}),n.preventDefault()}.bind(this,e,t);document.addEventListener("copy",o);try{document.execCommand("copy")}finally{document.removeEventListener("copy",o)}return e.success}function v(t,e){y(t);var o=b(e);return w(),o}function y(t){var e=document.getSelection();if(e){var o=document.createRange();o.selectNodeContents(t),e.removeAllRanges(),e.addRange(o)}}function w(){var t=document.getSelection();t&&t.removeAllRanges()}function x(t){var e=new s;return e.setData(p,t),e}function _(){return"undefined"==typeof ClipboardEvent&&void 0!==window.clipboardData&&void 0!==window.clipboardData.setData}},"5f34":function(t,e,o){},"85ae":function(t,e,o){"use strict";o.r(e);o("8e6e"),o("456d"),o("7f7f");var a=o("bd86"),n=(o("ac6a"),o("f749")),r=o("2ef0"),i=o("2af7");function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,a)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(o,!0).forEach(function(t){Object(a.a)(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(o).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}var c={components:{csUpload:function(){return o.e("chunk-f8fdc73c").then(o.bind(null,"8422"))}},props:{loading:{default:!1},tableData:{default:function(){return[]}}},data:function(){return{qrcodeUrl:"",qrcodeImage:"",currentTableData:[],multipleSelection:[],auth:{add:!1,set:!1,del:!1,view:!1},dialogLoading:!1,dialogFormVisible:!1,dialogStatus:"",dialogQrcodeVisible:!1,qrcodeData:{name:"",text:"",url:""},textMap:{update:"编辑二维码",create:"新增二维码"},form:{name:void 0,text:void 0,size:void 0,logo:void 0},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{max:50,message:"长度不能大于 50 个字符",trigger:"blur"}],text:[{required:!0,message:"内容不能为空",trigger:"blur"},{max:255,message:"内容不能大于 255 个字符",trigger:"blur"}],logo:[{max:512,message:"长度不能大于 512 个字符",trigger:"blur"}],size:[{type:"number",message:"必须为数字值",trigger:"blur"}]}}},computed:{changeQrcode:function(){var t=this.form;return{text:t.text,size:t.size,logo:t.logo}}},watch:{tableData:{handler:function(t){this.currentTableData=t},immediate:!0},changeQrcode:{handler:function(){var t=this;this.$nextTick(function(){t._getQrcodeImage()})}},dialogQrcodeVisible:{handler:function(t){!1===t&&(this.qrcodeData.url="")}}},mounted:function(){var e=this;this._validationAuth(),Object(n.c)().then(function(t){e.qrcodeUrl=t.data.call_url})},methods:{_validationAuth:function(){this.auth.add=this.$has("/system/aided/qrcode/add"),this.auth.set=this.$has("/system/aided/qrcode/set"),this.auth.del=this.$has("/system/aided/qrcode/del"),this.auth.view=this.$has("/system/aided/qrcode/view")},_getIdList:function(t){null===t&&(t=this.multipleSelection);var e=[];return Array.isArray(t)?t.forEach(function(t){e.push(t.qrcode_id)}):e.push(this.currentTableData[t].qrcode_id),e},_getQrcodeImage:Object(r.debounce)(function(){if(this.form.text){var t="?text=".concat(this.form.text,"&size=").concat(this.form.size,"&logo=").concat(this.form.logo);this.qrcodeImage=this.qrcodeUrl+encodeURI(t)}},500),_getUploadFileList:function(t){if(t.length){var e=t[0].response;e&&200===e.status&&(this.form.logo=document.location.protocol+"//"+e.data[0].url)}},handleSelectionChange:function(t){this.multipleSelection=t},sortChange:function(t){var e=t.column,o=t.prop,a=t.order,n={order_type:void 0,order_field:void 0};e&&a&&(n.order_type="ascending"===a?"asc":"desc",n.order_field=o),this.$emit("sort",n)},handleCreate:function(){var t=this;this.qrcodeImage="",this.form={name:"",text:"",size:3,logo:""},this.$nextTick(function(){t.$refs.form.clearValidate()}),this.dialogStatus="create",this.dialogLoading=!1,this.dialogFormVisible=!0},create:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.dialogLoading=!0,Object(n.a)(s({},e.form)).then(function(t){e.currentTableData.unshift(t.data),e.dialogFormVisible=!1,e.$message.success("操作成功")}).catch(function(){e.dialogLoading=!1}))})},handleDelete:function(t){var e=this,o=this._getIdList(t);0!==o.length?this.$confirm("确定要执行该操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){Object(n.b)(o).then(function(){for(var t=e.currentTableData.length-1;0<=t;t--)-1!==o.indexOf(e.currentTableData[t].qrcode_id)&&e.currentTableData.splice(t,1);e.currentTableData.length<=0&&e.$emit("refresh",!0),e.$message.success("操作成功")})}).catch(function(){}):this.$message.error("请选择要操作的数据")},handleUpdate:function(t){var e=this;this.qrcodeImage="",this.currentIndex=t,this.form=s({},this.currentTableData[t]),this.$nextTick(function(){e.$refs.form.clearValidate()}),this.dialogStatus="update",this.dialogLoading=!1,this.dialogFormVisible=!0},update:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.dialogLoading=!0,Object(n.e)(s({},e.form)).then(function(t){e.$set(e.currentTableData,e.currentIndex,s({},e.currentTableData[e.currentIndex],{},t.data)),e.dialogFormVisible=!1,e.$message.success("操作成功")}).catch(function(){e.dialogLoading=!1}))})},handleView:function(t){var e=this.currentTableData[t];this.qrcodeData={name:e.name,text:e.text,url:this.qrcodeUrl+"?qrcode_id=".concat(e.qrcode_id)},this.dialogQrcodeVisible=!0},handleCopy:function(){var e=this;i.a(this.qrcodeData.url).then(function(){e.$message.success("已复制调用地址到剪贴板")}).catch(function(t){e.$message.error(t)})}}},d=(o("b738"),o("2877")),u=Object(d.a)(c,function(){var o=this,t=o.$createElement,a=o._self._c||t;return a("div",{staticClass:"cs-p"},[a("el-form",{attrs:{inline:!0,size:"small"}},[o.auth.add?a("el-form-item",[a("el-button",{attrs:{disabled:o.loading},on:{click:o.handleCreate}},[a("cs-icon",{attrs:{name:"plus"}}),o._v("\n        新增二维码\n      ")],1)],1):o._e(),o.auth.del?a("el-form-item",[a("el-button",{attrs:{disabled:o.loading},on:{click:function(t){return o.handleDelete(null)}}},[a("cs-icon",{attrs:{name:"trash-o"}}),o._v("\n        删除\n      ")],1)],1):o._e(),a("cs-help",{staticStyle:{"padding-bottom":"19px"},attrs:{router:o.$route.path}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:o.loading,expression:"loading"}],attrs:{data:o.currentTableData,stripe:""},on:{"selection-change":o.handleSelectionChange,"sort-change":o.sortChange}},[a("el-table-column",{attrs:{type:"selection",width:"35"}}),a("el-table-column",{attrs:{label:"名称",prop:"name","min-width":"180"}}),a("el-table-column",{attrs:{label:"内容",prop:"text","min-width":"220","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"Logo",prop:"logo",align:"center"},scopedSlots:o._u([{key:"default",fn:function(e){return[e.row.logo?a("el-popover",{attrs:{width:"150",placement:"top",trigger:"hover"}},[a("div",{staticClass:"popover-image"},[a("el-image",{attrs:{src:e.row.logo,fit:"fill"},nativeOn:{click:function(t){return o.$preview(e.row.logo)}}})],1),a("cs-icon",{attrs:{slot:"reference",name:"image"},slot:"reference"})],1):o._e()]}}])}),a("el-table-column",{attrs:{label:"尺寸",prop:"size",sortable:"custom",width:"75"}}),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"100"},scopedSlots:o._u([{key:"default",fn:function(e){return[o.auth.view?a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return o.handleView(e.$index)}}},[o._v("详细")]):o._e(),o.auth.set?a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return o.handleUpdate(e.$index)}}},[o._v("编辑")]):o._e(),o.auth.del?a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return o.handleDelete(e.$index)}}},[o._v("删除")]):o._e()]}}])})],1),a("el-dialog",{attrs:{title:o.textMap[o.dialogStatus],visible:o.dialogFormVisible,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){o.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:o.form,rules:o.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入二维码名称",clearable:!0},model:{value:o.form.name,callback:function(t){o.$set(o.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"内容",prop:"text"}},[a("el-input",{attrs:{placeholder:"请输入二维码内容",type:"textarea",rows:3},model:{value:o.form.text,callback:function(t){o.$set(o.form,"text",t)},expression:"form.text"}})],1),a("el-form-item",{attrs:{label:"Logo",prop:"logo"}},[a("el-input",{attrs:{placeholder:"可输入二维码Logo链接",clearable:!0},model:{value:o.form.logo,callback:function(t){o.$set(o.form,"logo",t)},expression:"form.logo"}},[a("cs-upload",{attrs:{slot:"append",type:"slot",accept:"image/*",limit:1,multiple:!1},on:{confirm:o._getUploadFileList},slot:"append"},[a("el-button",{attrs:{slot:"control"},slot:"control"},[a("cs-icon",{attrs:{name:"upload"}})],1)],1)],1)],1),a("el-form-item",{attrs:{label:"尺寸",prop:"size"}},[a("el-input-number",{staticStyle:{width:"120px"},attrs:{"controls-position":"right",min:1,max:10},model:{value:o.form.size,callback:function(t){o.$set(o.form,"size",t)},expression:"form.size"}})],1)],1),a("el-divider",[o._v("效果预览")]),o.form.text?a("div",{staticStyle:{"text-align":"center"}},[o.qrcodeImage?a("el-image",{attrs:{fit:"fill",src:o.qrcodeImage}}):o._e()],1):o._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){o.dialogFormVisible=!1}}},[o._v("取消")]),"create"===o.dialogStatus?a("el-button",{attrs:{type:"primary",loading:o.dialogLoading,size:"small"},on:{click:o.create}},[o._v("确定")]):a("el-button",{attrs:{type:"primary",loading:o.dialogLoading,size:"small"},on:{click:o.update}},[o._v("修改")])],1)],1),a("el-dialog",{attrs:{title:"二维码预览",visible:o.dialogQrcodeVisible,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){o.dialogQrcodeVisible=t}}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("p",[o._v("效果预览")])]),a("el-col",{attrs:{span:20}},[o.qrcodeData.url?a("el-image",{attrs:{fit:"fill",src:o.qrcodeData.url}}):o._e()],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("p",[o._v("名称")])]),a("el-col",{attrs:{span:20}},[a("p",[o._v(o._s(o.qrcodeData.name))])])],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("p",[o._v("实际内容")])]),a("el-col",{attrs:{span:20}},[a("p",[o._v(o._s(o.qrcodeData.text))])])],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("p",[o._v("调用地址")])]),a("el-col",{attrs:{span:20}},[a("p",[o._v(o._s(o.qrcodeData.url))])])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:o.handleCopy}},[o._v("复制调用地址")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){o.dialogQrcodeVisible=!1}}},[o._v("确定")])],1)],1)],1)},[],!1,null,"cf4e7a66",null);e.default=u.exports},b738:function(t,e,o){"use strict";var a=o("5f34");o.n(a).a}}]);